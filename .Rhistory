count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
leftnodes[count]
set.seed(123)
ui <- gen_tree_structure(40)
ui$nodelist
leftnodes <- 1
count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
ui$leftnodes
ui <- gen_tree_structure(100)
ui$nodelist
leftnodes <- 1
count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
ui$leftnodes
ui <- gen_tree_structure(500)
leftnodes <- 1
count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
ui$leftnodes
ui$rightnodes
rigthnodes <- 1
leftnodes
set.seed(123)
ui <- gen_tree_structure(20)
leftnodes <- 1
count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
rigthnodes <- 1
rightnodes <- 1
leftnodes
leftnodes[-(1:2)]
leftnodes[-(1:2)]-1
ui$nodelist[[length(ui$nodelist)]]
rightnodes <- c(1, leftnodes[-(1:2)]-1, max(ui$nodelist[[length(ui$nodelist)]]))
rightnodes
ui <- gen_tree_structure(500)
# ui$nodelist
leftnodes <- 1
count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
rightnodes <- c(1, leftnodes[-(1:2)]-1, max(ui$nodelist[[length(ui$nodelist)]]))
leftnodes
rightnodes
ui$leftnodes
ui$rightnodes
leftnodes[length(leftnodes)]
set.seed(123)
ui <- gen_tree_structure(20)
# ui$nodelist
leftnodes <- 1
count <- 1
while(leftnodes[count] <= length(ui$nodelist)) {
leftnodes[count+1] <- ui$nodelist[[leftnodes[count]]][1]
count <- count+1
}
leftnodes
rightnodes <- c(1, leftnodes[-(1:2)]-1, max(ui$nodelist[[length(ui$nodelist)]]))
leftnodes
rightnodes
leftnodes[length(leftnodes)]:rightnodes[length(leftnodes)]
1 + 3.5
300*7*12
300*7*12 - 500*7*3
ui <- "          data_algorithm[[i]] <- data.table::fread(file.path(main_dir,\"output/simulated_data/150100\", str_subset(files_algorithm, paste(algorithm))[[i]]) , stringsAsFactors = FALSE) %>% setNames(.,c(\"elapsed\", paste(algorithm)))"
nchar(ui)
matrix(nrow=n, ncol=7, data=sample(c(0,1), size=n*7, replace=TRUE))
n <- 10
unique(matrix(nrow=n, ncol=7, data=sample(c(0,1), size=n*7, replace=TRUE)))
aha <- unique(matrix(nrow=n, ncol=7, data=sample(c(0,1), size=n*7, replace=TRUE)))
n <- 1000000
aha <- unique(matrix(nrow=n, ncol=7, data=sample(c(0,1), size=n*7, replace=TRUE)))
dim(aha)
2^7
head(aha)
aha2 <- aha[order(aha[,1], aha[,2], aha[,3], aha[,4], aha[,5], aha[,6], aha[,7]),]
head(aha2)
fix(aha2)
nchar("Prediction approaches for partly missing multi-omics covariate data: A literature review and an empirical comparison study")
nchar("Prediction approaches for partly missing multi-omics covariate data")
nchar("Empirical comparison study of approaches for partly missing multi-omics covariate data")
nchar("Existing prediction approaches for partly missing multi-omics covariate data")
nchar("Multi-omics data are high-dimensional molecular data for which several types of omics data (e.g., RNA data) are available for the same patients. A common issue in prediction using multi-omics data is that some of the considered omics data types are only available for subsets of the patients.")
toupper("Existing prediction approaches for partly missing multi-omics covariate data")
toupper("Empirical comparison study of approaches for partly missing multi-omics covariate data")
toupper("Availability of data and materials")
toupper("Acknowledgements")
86/52.1429
86/365
1/(86/365)
1/(69/365)
1/((86+69)/365)
1/((86+69)/2/365)
70/52.1429
uia <- list.files("D:/Projects/SideProjects/BlockwiseMissing/GitHub_Code/bwm_article/compstudy_code_and_results/results/pl_approach")
uia
uia1 <- setdiff(uia, c("PL_Eval_ESCA_2_4_3.csv", "PL_Eval_ESCA_4_4_3.csv", "PL_Eval_ESCA_old.csv", "PL_Eval_PAAD_4_4_5.csv", "PL_Eval_PAAD_old.csv"))
uia2 <- c("PL_Eval_ESCA_2_4_3.csv", "PL_Eval_ESCA_4_4_3.csv", "PL_Eval_ESCA_old.csv", "PL_Eval_PAAD_4_4_5.csv", "PL_Eval_PAAD_old.csv")
uia1
uia2
for(in in seq(along=ui1))
cat(paste(uia, collapse=", "), "\n")
cat(paste(uia2, collapse=", "), "\n")
args <- commandArgs(trailingOnly = TRUE)
args
library(ordinalForest)
install.packages("ordinalForest")
library(ordinalForest)
ls()
rm(list=ls());gc()
load("D:/Projects/RRBiomJournal/2022-10-10-Qin-bimj.202200021.R2/NewRevision/Code_and_Data/Simulation_Study/Results/Table4_5.RData")
ls()
fix(Table4_5)
table(Table4_5$Method)
ui <- Table4_5[Table4_5$Method=="IF",]
fix(ui)
ui <- Table4_5[Table4_5$Method=="IF" Table4_5$P1_P3==0.8,]
ui <- Table4_5[Table4_5$Method=="IF" & Table4_5$P1_P3==0.8,]
fix(ui)
ui <- Table4_5[Table4_5$Method=="IF" & Table4_5$P1_P3==0.8 & Table4_5$n1==50 &
Table4_5$n2==50 & Table4_5$n3==50,]
fix(ui)
A <- 1:50
B <- 51:100
sample(c(A, B), size=2)
setwd("D:/Projects/DESTATIS/PredErrorComplex/PPerfEstComplex")
source("./simulations/hierpr/functions.R")
load("./simulations/hierpr/results/intermediate_results/treestruc.Rda")
# Make a list which will contain the coefficients of the simulation models
# and other information:
# treestruc
coeflist <- vector(mode = "list", length = length(treestruc$nodelist))
for(i in seq(along=coeflist)) {
coeflist[[i]] <- list()
# Add the information on the child nodes for each node:
coeflist[[i]]$childnodes <- treestruc$nodelist[[i]]
# Add the information on the parent nodes for each node:
coeflist[[i]]$parentnodes <- which(sapply(1:length(coeflist), function(x) i %in% coeflist[[x]]$childnodes))
# Add the layer of each node:
coeflist[[i]]$layer <- which(sapply(1:length(treestruc$leftnodes), function(x) (i >= treestruc$leftnodes[x]) & (i <= treestruc$rightnodes[x])))
}
# Simulate the coefficients:
set.seed(1234)
# Variance of the normal distribution from which the intercepts are drawn:
sdbeta0 <- sqrt(1)
# The betas have layer-specific variances:
sdbeta <- sqrt(c(1, 1.5, 2, 2.5, 3))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
for(i in seq(along=coeflist)) {
# if(coeflist[[i]]$layer==maxlayer) {
#   coeflist[[i]]$coefs <- NA
# } else {
if(length(coeflist[[i]]$childnodes)==2) {
coefs <- matrix(nrow=1, ncol=6, data=c(rnorm(1, sd=sdbeta0), rnorm(5, sd=sdbeta[coeflist[[i]]$layer])))
}
if(length(coeflist[[i]]$childnodes)==3) {
coefs <- rbind(c(rnorm(1, sd=sdbeta0), rnorm(5, sd=sdbeta[coeflist[[i]]$layer])),
c(rnorm(1, sd=sdbeta0), rnorm(5, sd=sdbeta[coeflist[[i]]$layer])))
}
coeflist[[i]]$coefs <- coefs
# }
}
rm(list=ls());gc()
source("./simulations/hierpr/functions.R")
load("./simulations/hierpr/results/intermediate_results/treestruc.Rda")
simulate_coefs <- function(treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3))) {
coeflist <- vector(mode = "list", length = length(treestruc$nodelist))
for(i in seq(along=coeflist)) {
coeflist[[i]] <- list()
# Add the information on the child nodes for each node:
coeflist[[i]]$childnodes <- treestruc$nodelist[[i]]
# Add the information on the parent nodes for each node:
coeflist[[i]]$parentnodes <- which(sapply(1:length(coeflist), function(x) i %in% coeflist[[x]]$childnodes))
# Add the layer of each node:
coeflist[[i]]$layer <- which(sapply(1:length(treestruc$leftnodes), function(x) (i >= treestruc$leftnodes[x]) & (i <= treestruc$rightnodes[x])))
}
# Simulate the coefficients:
maxlayer <- max(sapply(coeflist, function(x) x$layer))
for(i in seq(along=coeflist)) {
# if(coeflist[[i]]$layer==maxlayer) {
#   coeflist[[i]]$coefs <- NA
# } else {
if(length(coeflist[[i]]$childnodes)==2) {
coefs <- matrix(nrow=1, ncol=6, data=c(rnorm(1, sd=sdbeta0), rnorm(5, sd=sdbeta[coeflist[[i]]$layer])))
}
if(length(coeflist[[i]]$childnodes)==3) {
coefs <- rbind(c(rnorm(1, sd=sdbeta0), rnorm(5, sd=sdbeta[coeflist[[i]]$layer])),
c(rnorm(1, sd=sdbeta0), rnorm(5, sd=sdbeta[coeflist[[i]]$layer])))
}
coeflist[[i]]$coefs <- coefs
# }
}
return(coeflist)
}
get_child_nodes <- function(Xsub, coefs) {
desmat <- cbind(1, Xsub)
if (nrow(coefs)==2)
vProb <- cbind(1, exp(desmat%*%coefs[1,]), exp(desmat%*%coefs[2,]))
else
vProb <- cbind(1, exp(desmat%*%coefs[1,]))
mChoices <- t(apply(vProb, 1, rmultinom, n = 1, size = 1))
ys <- apply(mChoices, 1, function(x) which(x==1))
return(ys)
}
n <- 5000
X <- matrix(nrow=n, ncol=5, rnorm(n*5))
# innerclasses
set.seed(1234)
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
outcomemat <- matrix(nrow=nrow(X), ncol=10)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
fix(outcomemat)
maxlayer <- max(sapply(coeflist, function(x) x$layer))
maxlayer
set.seed(1234)
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
coeflist <- simulate_coefs(treestruc=treestruc, sdbeta0=sqrt(1),
sdbeta=sqrt(c(1, 1.5, 2, 2.5, 3)))
maxlayer <- max(sapply(coeflist, function(x) x$layer))
outcomemat <- matrix(nrow=nrow(X), ncol=maxlayer)
tempclass <- coeflist[[1]]$childnodes[get_child_nodes(X, coeflist[[1]]$coefs)]
outcomemat[,1] <- tempclass
coeflist[[1]]$datanode <- data.frame(X)
coeflist[[1]]$datanode$y <- factor(tempclass)
for(i in 2:(length(coeflist)-1)) {
subs <- outcomemat[,coeflist[[i]]$layer-1]==i
tempclass <- coeflist[[i]]$childnodes[get_child_nodes(X[subs,], coeflist[[i]]$coefs)]
outcomemat[subs,coeflist[[i]]$layer] <- tempclass
coeflist[[i]]$datanode <- data.frame(X[subs,])
coeflist[[i]]$datanode$y <- factor(tempclass)
}
# fix(outcomemat)
length(table(outcomemat[,5]))
barplot(table(outcomemat[,5]))
